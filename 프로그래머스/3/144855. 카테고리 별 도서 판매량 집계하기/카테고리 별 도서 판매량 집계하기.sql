WITH A AS(
SELECT BS.BOOK_ID AS ID, SUM(SALES) AS SALES
FROM BOOK_SALES AS BS
WHERE YEAR(SALES_DATE)=2022 AND MONTH(SALES_DATE)= 1
GROUP BY(ID)
)
SELECT CATEGORY, SUM(SALES) AS TOTAL_SALES
FROM BOOK 
JOIN A
ON BOOK_ID = A.ID
GROUP BY CATEGORY
ORDER BY CATEGORY



/*
1. 해당 날짜 id,sales select
2. id, category select
3. left join
4. id 날짜 카테고리 sales
5. 그룹바이 카테고리, sum (sales) order by






*/